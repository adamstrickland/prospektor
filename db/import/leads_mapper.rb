class LeadsMapper < Pipeline::TransformMapper
  @phone_from_float = lambda{ |val, ctxt| val.to_i.to_s }
  @int_from_float = lambda{ |val, ctxt| val.to_i }
  @downcase = lambda{ |val, ctxt| val ? val.downcase == "own" : false }
  
  define_mappings({
    "LeadID" => { :to => :id },
    "Name" => { :to => :name },
    "Lastname" => { :to => :last_name },
    "Firstname" => { :to => :first_name },
    "Salutation" => { :to => :salutation },
    "Title" => { :to => :title },
    "Gender" => { :to => :gender },
    "Company" => { :to => :company },
    "Year Established" => { :to => :year_established },
    "Address" => { :to => :address },
    "City" => { :to => :city },
    "State" => { :to => :state },
    "County" => { :to => :county },
    "Zip" => { :to => :zip },
    "Phone" => { :to => :phone, :transform => @phone_from_float },
    "Extension" => { :to => :extension },
    "Fax" => { :to => :fax, :transform => @phone_from_float },
    "Cell Phone" => { :to => :cell_phone, :transform => @phone_from_float },
    "Employee Actual" => { :to => :employee_actual },
    "Employee Code" => { :to => :employee_code, :transform => @int_from_float },
    "Sales Actual" => { :to => :sales_actual },
    "Sales Code" => { :to => :sales_code, :transform => @int_from_float },
    "SIC Code" => { :to => :sic_code_1 },
    "SIC Description" => { :to => :sic_description_1 },
    "SIC_02" => { :to => :sic_code_2 },
    "DESCRIPTION_02" => { :to => :sic_description_2 },
    "SIC_03" => { :to => :sic_code_3 },
    "DESCRIPTION_03" => { :to => :sic_description_3 },
    "SIC_04" => { :to => :sic_code_4 },
    "DESCRIPTION_04" => { :to => :sic_description_4 },
    "SIC_05" => { :to => :sic_code_5 },
    "DESCRIPTION_05" => { :to => :sic_description_5 },
    "MSA" => { :to => :msa },
    "WEB" => { :to => :web },
    "e-mail" => { :to => :email },
    "Number of PCs" => { :to => :number_of_pcs },
    "Square Footage" => { :to => :square_footage },
    "Own or Lease" => { :to => :own_property, :transform => @downcase },
    "Credit Rating" => { :to => :credit_rating },
    "Credit Numeric Score" => { :to => :credit_score },
    "Source" => { :to => :source },
    "Imported" => { :to => :imported_at },
    "Updated" => { :to => :updated_at },
    "Time Zone" => { :to => :timezone },
    "UserID" => { :to => :user_id }
  })
end